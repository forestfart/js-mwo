<html> 
   <head> 
      <title>Demonstracja działania Ajaksa</title>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

      <script language = "javascript">
         var XMLHttpRequestObject = false; 

         try { 
            XMLHttpRequestObject = new ActiveXObject("MSXML2.XMLHTTP"); 
         } catch (exception1) { 
            try { 
               XMLHttpRequestObject = new ActiveXObject("Microsoft.XMLHTTP"); 
            } catch (exception2) { 
               XMLHttpRequestObject = false; 
            } 
         } 

         if (!XMLHttpRequestObject && window.XMLHttpRequest) { 
            XMLHttpRequestObject = new XMLHttpRequest(); 
         } 

         function getData(dataSource, divID) 
         { 
            if(XMLHttpRequestObject) {
               var obj = document.getElementById(divID); 
               XMLHttpRequestObject.open("GET", dataSource); 

               XMLHttpRequestObject.onreadystatechange = function() 
               { 
                  if (XMLHttpRequestObject.readyState == 4 && XMLHttpRequestObject.status == 200)
                  { 
                     obj.innerHTML = XMLHttpRequestObject.responseText; 
                  } 
               } 

               XMLHttpRequestObject.send(null); 
            }
         }
      </script>
   </head> 

   <body>

      <H1>Demonstracja działania Ajaksa</H1>

      <form>
         <input type = "button" value = "Pobierz wiadomość" onclick = "getData('data.txt', 'targetDiv')"> 
      </form>

      <div id="targetDiv">
         <p>Pobrana wiadomość pokaże się tutaj.</p> 
      </div> 

   </body> 
</html>
